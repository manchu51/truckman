<head>
    <meta charset="UTF-8">
    <title>거래처 미수금 현황</title>

   <style>
    @media print {
         .no-print {
            display: none;
        }
        @page {
            size: A4 portrait;
            margin: 0mm 0mm;  /* 상단 여백 0mm, 좌우 여백 0mm */
        }
        body {
            font-family: Arial, sans-serif;
            font-size: smaller; /* 글자 크기를 작게 설정 */
            margin: 0;  /* 기본 margin 제거 */
        }
        .container { width: 100%; }
        h7 { text-align: center; font-size: 0.7em; margin: 0; padding: 2mm 0; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 2mm; }
        th, td {
            border: 1px solid #ddd; /* 각 칼럼에 가는 선 테두리 */
            padding: 5px;
            text-align: center;
            font-size: smaller;
        }
        th { background-color: #ffddee; }
        .total-row td { border: none; font-weight: bold; }
        .no-print { display: none; }
        /* 머리글과 바닥글 제거 */
        header, footer {
            display: none;
        }
    }
    /* Additional styling for screen view */
    body { font-family: Arial, sans-serif; }
    .container { margin: 20px auto; width: 90%; }
    h5 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin: 20px 1; }
    th, td {
        border: 1px solid #ddd; /* 화면에서도 같은 스타일 적용 */
        padding: 8px;
    }
    th { background-color: #f2f2f2; text-align: center; }
    .total-row td { font-weight: bold; }
    .text-center { text-align: center; }
    .small-text { font-size: smaller; }
</style>

    <script>
        function printContent() {
            window.print();
        }
    </script>

</head>
<body>
{% extends "base.html" %}
{% block content %}
<br><br><br>
<div class="container">

    <table style="width:100%">
        <thead>
        <tr>
            <td colspan="5" align="center"><strong>
                {{ trans_company }}&nbsp;&nbsp;&nbsp;&nbsp;미수금 현황</strong>
            </td>
            <td colspan="2" align="right">&nbsp;&nbsp;&nbsp;&nbsp;
                <strong>오늘 날짜 : {{ today_date }}</strong>
            </td>
        </tr>

        <tr>
            <th style="width:3%; text-align:center; border: 1px solid #ddd;">NO</th>
            <th style="width:15%; text-align:center; border: 1px solid #ddd;">운송일자</th>
            <th style="width:13%; text-align:center; border: 1px solid #ddd;">송하주</th>
            <th style="width:23%; text-align:center; border: 1px solid #ddd;">상차지</th>
            <th style="width:13%; text-align:center; border: 1px solid #ddd;">수하주</th>
            <th style="width:23%; text-align:center; border: 1px solid #ddd;">하차지</th>
            <th style="width:10%; text-align:center; border: 1px solid #ddd;">운송료</th>
        </tr>
        </thead>

        <tbody>
        {% set ns = namespace(total_amount=0) %}
        {% for idx, transport in enumerate(transports) %}
        <tr>
            <td style="text-align:center; border: 1px solid #ddd;">{{ loop.index }}</td>
            <td style="text-align:center; border: 1px solid #ddd;">{{ transport.trans_date }}</td>
            <td style="text-align:center; border: 1px solid #ddd;">{{ transport.consignor }}</td>
            <td style="border: 1px solid #ddd;">{{ transport.load_region }}</td>
            <td style="text-align:center; border: 1px solid #ddd;">{{ transport.consignee }}</td>
            <td style="border: 1px solid #ddd;">{{ transport.unload_region }}</td>
            <td style="text-align:center; border: 1px solid #ddd;">{{ "{:,.0f}".format(transport.trans_amount or 0) }}&nbsp;</td>
            {% set ns.total_amount = ns.total_amount + (transport.trans_amount or 0) %}
        </tr>
        {% endfor %}

        <tr class="total-row">
            <td colspan="6" align="center">총 금액</td>
             <td align="center">{{ "{:,.0f}".format(ns.total_amount) }}&nbsp;</td>
        </tr>

        </tbody>

    </table>

    <div>
        <table>
            <tr>
                <th> <button onclick="printContent()" class="btn btn-secondary">인쇄하기</button></th>
                <th> <button onclick="sendSms()" class="btn btn-secondary">문자 메세지 보내기</button></th>
                <th> <button onclick="sendFax()" class="btn btn-secondary">팩스 보내기</button></th>
                <th> <button onclick="sendEmail()" class="btn btn-secondary">이메일 보내기</button></th>
            </tr>
        </table>
    </div>


</div>

<!-- 스크립트는 페이지 하단에 포함 -->
<script>
    function printContent() {
         const bodyContent = document.body.innerHTML;
         const printContent = document.querySelector('.container').outerHTML;

         document.body.innerHTML = printContent;  // 전체 내용 대신 컨테이너만 인쇄
            window.print();
            document.body.innerHTML = bodyContent;  // 원래 내용으로 복구
        }
</script>

</body>
{% endblock %}
