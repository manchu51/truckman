

<head>
    <meta charset="UTF-8">
    <title>미수금현황</title>

    <style>
        @media print {
            @page { size: A4; margin: 2mm 2mm; }
            body { margin: 2mm 2mm; font-family: Arial, sans-serif; font-size: smaller; }
            .container { width: 100%; }
            h6 { text-align: center; font-size: 0.9em; margin: 0; padding: 2mm 0; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 2mm; }
            th, td { border: 1px solid #000; padding: 5px; text-align: center; font-size: smaller; }
            th { background-color: #ffddee; }
            .total-row td { border: none; font-weight: bold; }
            .no-print { display: none; }
        }
        /* Additional styling for screen view */
        body { font-family: Arial, sans-serif; }
        .container { margin: 20px auto; width: 80%; }
        h5 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; text-align: center; }
        .total-row td { font-weight: bold; }
        .text-center { text-align: center; }
        .small-text { font-size: smaller; }
    </style>
    <script>
        function printContent() {
            const printButton = document.querySelector('.no-print');
            const bodyContent = document.body.innerHTML;
            const printContent = document.querySelector('.container').outerHTML;
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = bodyContent;
        }
    </script>

</head>
<body>
{% extends "base.html" %}
{% block content %}
<br>
    <div class="container">
        <h6 align="center" class="text-center">{{ trans_company }}&nbsp;&nbsp;미수금현황&nbsp;&nbsp;&nbsp;&nbsp;
        오늘 날짜 : {{ today_date }}</h6>
        <table style="width:100%">
            <thead>
                <tr>
                    <th style="width:4%" class="text-center">NO</th>
                    <th style="width:10%" class="text-center">운송일자</th>
                    <th style="width:14%" class="text-center">송하주</th>
                    <th style="width:21%" class="text-center">상차지</th>
                    <th style="width:14%" class="text-center">수하주</th>
                    <th style="width:21%" class="text-center">하차지</th>
                    <th style="width:8%" class="text-center">운송료</th>
                    {% if show_brokerage_fee %}
                        <th style="width:8%" class="text-center">알선료</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% set ns = namespace(total_amount=0, total_fee=0) %}
                {% for idx, transport in enumerate(transports) %}
                <tr>
                    <td align="center">{{ loop.index }}</td>
                    <td align="center">{{ transport.trans_date }}</td>
                    <td align="center">{{ transport.consignor }}</td>
                    <td>{{ transport.load_region }}</td>
                    <td align="center">{{ transport.consignee }}</td>
                    <td>{{ transport.unload_region }}</td>
                    <td align="right">{{ "{:,.0f}".format(transport.trans_amount or 0) }}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                    {% set ns.total_amount = ns.total_amount + (transport.trans_amount or 0) %}
                    {% if show_brokerage_fee %}
                        <td align="right">{{ "{:,.0f}".format(transport.brokerage_fee or 0) }}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                        {% set ns.total_fee = ns.total_fee + (transport.brokerage_fee or 0) %}
                    {% endif %}
                </tr>
                {% endfor %}
                <tr class="total-row">
                    <td colspan="6" align="center">총 금액</td>
                    <td align="right">{{ "{:,.0f}".format(ns.total_amount) }}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                    {% if show_brokerage_fee %}
                        <td align="right">{{ "{:,.0f}".format(ns.total_fee) }}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                    {% endif %}
                </tr>
            </tbody>
        </table>
    </div>

    <div class="text-center no-print">
        <button onclick="printContent()" class="btn btn-secondary">인쇄하기</button>
    </div>
</body>
{% endblock %}
